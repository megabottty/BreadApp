<nav class="main-nav">
  <a routerLink="/front" class="nav-brand" (click)="closeMenu()">{{title()}}</a>

  <button class="menu-toggle" (click)="toggleMenu()" [attr.aria-expanded]="isMenuOpen()" aria-label="Toggle navigation">
    <span class="hamburger"></span>
  </button>

  <div class="nav-links" [class.open]="isMenuOpen()">
    @if (authService.isBaker()) {
      <a routerLink="/calculator" routerLinkActive="active" (click)="closeMenu()">Recipe Lab</a>
      <a routerLink="/manage-orders" routerLinkActive="active" (click)="closeMenu()">Manage Orders</a>
      <a routerLink="/ledger" routerLinkActive="active" (click)="closeMenu()">Ledger</a>
    }
    <a routerLink="/front" routerLinkActive="active" (click)="closeMenu()">Storefront</a>
    <a routerLink="/about" routerLinkActive="active" (click)="closeMenu()">About Us</a>
    <a routerLink="/cart" routerLinkActive="active" class="cart-link" (click)="closeMenu()">
      Bag
      @if (cartService.totalCount() > 0) {
        <span class="cart-badge">{{cartService.totalCount()}}</span>
      }
    </a>
    @if (authService.isCustomer()) {
      <a routerLink="/profile" routerLinkActive="active" (click)="closeMenu()">My Orders</a>
      <a routerLink="/subscriptions" routerLinkActive="active" (click)="closeMenu()">Subscriptions</a>
    }

    <button class="btn-theme-toggle" (click)="themeService.toggleTheme()" [title]="'Switch Theme (Current: ' + themeService.theme() + ')'">
      @if (themeService.theme() === 'natural') { ðŸŒ¿ }
      @else if (themeService.theme() === 'sunset') { ðŸŒ… }
      @else { ðŸŒ™ }
    </button>

    <div class="auth-controls">
      @if (!authService.isAuthenticated()) {
        <a routerLink="/login" class="btn-auth" (click)="closeMenu()">Login</a>
      } @else {
        <div class="user-info">
          <span class="user-role-badge" [class.baker]="authService.isBaker()">
            {{ authService.isBaker() ? 'Head Baker' : 'Bread Lover' }}
          </span>
          <span class="user-name">{{authService.user()?.name}}</span>
        </div>
        <button (click)="logout()" class="btn-auth logout">Logout</button>
      }
    </div>
  </div>
</nav>

<main>
  <router-outlet />
</main>

<app-footer></app-footer>

<app-notification-modal></app-notification-modal>
<app-product-customization-modal></app-product-customization-modal>
